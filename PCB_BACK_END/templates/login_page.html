<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Login | PCB Defect Detection</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
  <img src="{{ url_for('static', filename='images/login.gif') }}" alt="Background" class="bg-video">
  <div class="login-box">
    <h3 style="font-size: 30px;">USER LOGIN</h3>
    <form id="loginForm" method="POST" action="{{ url_for('login') }}">
      <input type="hidden" name="user_type" value="user">
      <input type="text" name="technician_id" placeholder="Technician ID" required><br>
      <input type="password" name="password" placeholder="Password" required><br>
      <button class="check-btn" type="submit">Login</button>
      {% if request.args.get('error') == 'invalid' %}
      <div class="error" id="errorMsg" style="display:block;">Invalid credentials</div>
      {% else %}
      <div class="error" id="errorMsg" style="display:none;">Invalid credentials</div>
      {% endif %}
    </form>
  </div>
  <script>
    // Clear previous session flags on load
    window.onload = function () {
      localStorage.removeItem('missing_done');
      localStorage.removeItem('burnt_done');
      localStorage.removeItem('voltage_done');
    };

    // Store user info in localStorage after successful login (handled by Flask redirect)
    document.getElementById('loginForm').addEventListener('submit', function (e) {
      const id = this.elements['technician_id'].value.trim();
      if (id === 'technician_1') {
        try {
          localStorage.setItem('technician_id', id);
          localStorage.setItem('technician_name', 'Mohan');
          localStorage.setItem('technician_rating', '4/5');
        } catch (e) { }
      }
    });
  </script>
</body>

</html>